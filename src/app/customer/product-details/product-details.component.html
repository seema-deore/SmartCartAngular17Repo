<div class="container py-5">
  <div class="row"> 
    <!-- align-items-center -->

    <!-- Left: Product Image -->
    <div class="col-md-6 mb-4 mb-md-0 text-center">
      <img src = {{product.productImageUrl}} alt="Product Image" class="img-fluid rounded shadow-sm" style="height:500px"/>
    </div>

    <!-- Right: Product Details -->
    <div class="col-md-4">
      <h2 class="fw-bold">{{product.productShortName}}</h2>
      <!-- <p class="text-muted">{{product.productDescription}}</p> -->
     <p class="text-muted">{{productDescription}}</p>
      <!-- Price and Discount -->
      <div class="mb-3">
        <h4>&#8377; <span class="text-muted text-decoration-line-through fs-6 ms-2">{{product.productPrice}} </span>                   
          <span class="badge bg-danger ms-2">25% OFF</span>
        </h4>
        <h4 class="text-success fw-bold">
          &#8377; {{(product.productPrice - (product.productPrice * 0.25)) | number:'1.0-0'}}
        </h4>
      </div>

      <!-- Quantity Selector -->
      <div class="d-flex align-items-center mb-3">
        <label class="me-3 fw-semibold">Quantity:</label>
        <div class="input-group" style="width: 120px;">
          <button class="btn btn-outline-secondary" type="button" (click)="decreaseQty()">−</button>
          <input type="text" class="form-control text-center" [(ngModel)]="quantity" readonly>
          <button class="btn btn-outline-secondary" type="button" (click)="increaseQty()">+</button>
        </div>
      </div>

      <!-- Delivery Time -->
      <div class="mb-3">
        <span class="text-muted">Delivery in: <strong>3–5 days</strong></span>
      </div>

      <!-- Buy/Add to Cart Buttons -->
      <div>
        <button class="btn bgcolor-primary text-white w-100 mb-2" (click)="onAddToCart(product)">Add To Cart</button>
        <button class="btn bgcolor-secondary text-primary w-100 mb-2">Buy Now</button>
        <button class="btn btn-outline-secondary w-100">
            <a [routerLink]="['/customer/products']" routerLinkActive="router-link-active" >Go To List</a></button>
      </div>
    </div>

  </div>
</div>


<!-- Nav Tabs -->
<ul class="nav nav-tabs mb-3" id="productTab" role="tablist">
    <li class="nav-item" role="presentation">
    <button class="nav-link active" id="reviews-tab" data-bs-toggle="tab" data-bs-target="#reviews" type="button" role="tab">Reviews</button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link" id="more-tab" data-bs-toggle="tab" data-bs-target="#more" type="button" role="tab">You might also like..</button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link " id="desc-tab" data-bs-toggle="tab" data-bs-target="#desc" type="button" role="tab">Extra Details</button>
  </li>
</ul>

<!-- Tab Panes -->
<div class="tab-content" id="productTabContent" >  
<!-- Reviews Tab Pane -->
<div class="tab-pane fade show active" id="reviews" role="tabpanel">

  <div class="row">
  <div class="col-lg-6">
    <h6>Customer Reviews</h6>

    <!-- List existing reviews -->
     @for(r of reviews ; track r.email){
    <div class="border p-3 mb-3 rounded">
      <strong>{{ r.name }}</strong>
      <small class="text-muted">({{ r.email }})</small>
      <span class="text-warning ms-2">
        <ng-container *ngFor="let star of [].constructor(r.rating)">&starf;</ng-container>
        <ng-container *ngFor="let star of [].constructor(5 - r.rating)">&star;</ng-container>
      </span>
      <p class="mb-0">{{ r.comment }}</p>
    </div>  }
</div>

    <!-- Add a new review -->
    <div class="col-lg-6">
      <h6>Add Your Review</h6>
      <form (ngSubmit)="addReview()" class="border p-3 rounded">
        <div class="mb-2">
          <input
            class="form-control"
            placeholder="Name"
            [(ngModel)]="newReview.name"
            name="name"
            required
          />
        </div>
        <div class="mb-2">
          <input
            type="email"
            class="form-control"
            placeholder="Email"
            [(ngModel)]="newReview.email"
            name="email"
            required
          />
        </div>
        <div class="mb-2">
          <textarea
            class="form-control"
            rows="2"
            placeholder="Your review"
            [(ngModel)]="newReview.comment"
            name="comment"
            required
          ></textarea>
        </div>
        <div class="mb-3">
          <label class="form-label">Rating:</label>
          <select
            class="form-select"
            [(ngModel)]="newReview.rating"
            name="rating"
            required
          >
            <option [ngValue]="5">5</option>
            <option [ngValue]="4">4</option>
            <option [ngValue]="3">3</option>
            <option [ngValue]="2">2</option>
            <option [ngValue]="1">1</option>
          </select>
        </div>
        <button type="submit" class="btn btn-primary btn-sm">Submit Review</button>
      </form>
    </div>
  </div>
</div>

  <!-- More Products -->
  
<div class="tab-pane fade" id="more" role="tabpanel">
  <!-- <h5 class="mt-3">More Products from {{ currentProduct.category }}</h5> -->

  <div class="d-flex overflow-auto gap-3 mt-3 pb-2">
    @for(product of sameCategoryProducts; track product.productId){
    <div class="card"  style="min-width: 200px; max-width: 200px;">
      <img
        [src]="product.productImageUrl"
        class="card-img-top"
        alt="{{ product.name }}"
        style="height: 150px; object-fit: cover;"
      />
      <div class="card-body p-2">
        <h6 class="card-title mb-1" style="font-size: 14px">{{ product.productName }}</h6>
        <p class="text-success mb-0" style="font-size: 13px">&#8377;{{ product.productPrice }}</p>
      </div>
    </div>
  }
  </div>
</div>
<!-- Description -->
  <div class="tab-pane fade" id="desc" role="tabpanel">
    <p>This is the product description.</p>
  </div>
</div>
