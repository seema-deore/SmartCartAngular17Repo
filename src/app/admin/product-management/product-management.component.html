<div class="bg-white border-top shadow-sm py-2">
  <div class="container">
    <div class="row g-2 align-items-center">
      
      <!-- Dropdown (All Categories) -->
      <div class="col-12 col-md-3">
  <div class="dropdown w-100">
    <button
      class="btn btn-outline-secondary w-100 dropdown-toggle"
      type="button"
      id="categoryDropdown"
      data-bs-toggle="dropdown"
      aria-expanded="false">
      {{selectedCategoryName || 'All Categories'}}
    </button>

    <ul
      class="dropdown-menu dropdown-full-width"
      aria-labelledby="categoryDropdown">

      <li>
          <a class="dropdown-item" (click)="onselectAllCategories()">
            All Categories
          </a>
          <hr class="dropdown-divider">
      </li>
      <li *ngFor="let category of categoryList">
        <a class="dropdown-item" (click)="onselectCategory(category.categoryId, category.categoryName)">
          {{ category.categoryName }}
        </a>
        <hr class="dropdown-divider">
      </li>
    
    </ul>
  </div>
</div>

      <!-- Search Field + Button -->
      <div class="col-12 col-md-9">
        <form class="d-flex w-100" role="search">
          <input
            class="form-control me-2"
            type="search" [(ngModel)]="searchText" [ngModelOptions]="{standalone: true}"
            placeholder="Search for items..."
            aria-label="Search"
          />
          <button class="btn border-secondary" type="submit"><i class="bi bi-search"></i></button>
      </form>
      </div>
    </div>
  </div>
</div>

<div class="container mt-2">
  <div class="d-flex justify-content-between align-items-center mb-2 mx-2">
    
    <button class="btn bgcolor-primary text-white px-5" (click)="openAddProduct()">+ Add Product</button>
  </div>

  <div class="row">
    <div class="col-md-3 mb-3" *ngFor="let product of productList | productSearch: searchText">
      <div class="card h-100 border-secondary">
        <img [src]="product.productImageUrl" class="card-img-top" alt="{{ product.productName }}" height="350px">
        <div class="card-body">
          <h5 class="card-title mb-0">{{ product.productName }}</h5>
          <!-- <p class="card-text">{{ product.productShortName }}</p> -->
          <p class="fw-bold">&#8377; {{ product.productPrice }}</p>
          <p class="text-muted">
            {{ product.categoryName }}</p>
        </div>
        <div class="card-footer d-flex justify-content-between bgcolor-secondary">
          <button class="btn btn-sm btn-warning" (click)="openEditProduct(product)">Edit</button>
          <button class="btn btn-sm btn-danger" data-bs-toggle="modal" data-bs-target="#exampleModal"
                (click)="getProductId(product.productId)">Delete</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Add/Edit Product Modal -->
<div id="productModal" class="modal" style="display:none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">{{ isEditMode ? 'Edit Product' : 'Add Product' }}</h5>
        <button type="button" class="btn-close" (click)="closeModal()"></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="productForm">
          <div >
            <label>SKU</label>
            <input type="text" formControlName="productSku" class="form-control">
          </div>
          <div>
            <label>Name</label>
            <input type="text" formControlName="productName" class="form-control">
          </div>
          <div>
            <label>Price</label>
            <input type="number" formControlName="productPrice" class="form-control">
          </div>
          <div>
            <label>Short Name</label>
            <input type="text" formControlName="productShortName" class="form-control">
          </div>
          <div>
            <label>Description</label>
            <textarea formControlName="productDescription" class="form-control"></textarea>
          </div>
          <div>
            <label>Delivery Time Span</label>
            <input type="text" formControlName="deliveryTimeSpan" class="form-control">
          </div>
          <!-- <div class="mb-3">
            <label>Category ID</label>
            <input type="number" formControlName="categoryId" class="form-control">
          </div> -->
          <div>
            <label>Category Name</label>
          <select formControlName="categoryId" class="form-select"> 
             
            <option *ngFor="let category of categoryList" [ngValue]="category.categoryId">
                {{ category.categoryName }}
            </option>
            </select>
            
          </div>
          <div>
            <label>Image URL</label>
            <input type="text" formControlName="productImageUrl" class="form-control">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary btn-sm" (click)="closeModal()">Cancel</button>
        <button class="btn btn-success btn-sm" (click)="saveProduct()">
          {{ isEditMode ? 'Update' : 'Add' }}
        </button>
      </div>
    </div>
  </div>
</div>
<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel"> Delete product</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        Do you want to delete?
      </div>
      <div class="modal-footer">
        
        <button type="button" class="btn btn-success btn-sm px-2" (click)="deleteProduct()" data-bs-dismiss="modal">Ok</button>
        <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">Cancel</button>
      </div>
    </div>
  </div>
</div>


